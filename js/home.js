(function() {
    // Variables
    var Photo, addListeners, canvas, createGrid, ctx, gridItem, grids, height, img, imgInfo, imgSrc, imgs, init, magnet, mouse, populateCanvas, render, resizeCanvas, rotateAndPaintImage, updateMouse, useGrid, width;
  
    canvas = document.getElementById('canvas');
  
    ctx = canvas.getContext('2d');
  
    width = canvas.width = window.innerWidth;
  
    height = canvas.height = window.innerHeight;
  
    imgSrc = canvas.dataset.image;
  
    img = new Image();
  
    useGrid = true;
  
    imgInfo = {};
  
    imgs = [];
  
    grids = [];
  
    magnet = 2000;
  
    mouse = {
      x: 1,
      y: 0
    };
  
    init = function() {
      addListeners();
      img.onload = function(e) {
        var numberToShow;
        // Check for firefox. 
        imgInfo.width = e.path ? e.path[0].width : e.target.width;
        imgInfo.height = e.path ? e.path[0].height : e.target.height;
        numberToShow = (Math.ceil(window.innerWidth / imgInfo.width)) * (Math.ceil(window.innerHeight / imgInfo.height));
        if (useGrid) {
          createGrid();
        }
        populateCanvas(numberToShow * 4);
        canvas.classList.add('ready');
        return render();
      };
      return img.src = imgSrc;
    };
  
    addListeners = function() {
      window.addEventListener('resize', resizeCanvas);
      window.addEventListener('mousemove', updateMouse);
      return window.addEventListener('touchmove', updateMouse);
    };
  
    updateMouse = function(e) {
      mouse.x = e.clientX;
      return mouse.y = e.clientY;
    };
  
    resizeCanvas = function() {
      width = canvas.width = window.innerWidth;
      return height = canvas.height = window.innerHeight;
    };
  
    
    // Magic
    populateCanvas = function(nb) {
      var i, p, results;
      i = 0;
      results = [];
      while (i <= nb) {
        p = new Photo();
        imgs.push(p);
        results.push(i++);
      }
      return results;
    };
  
    createGrid = function() {
      var c, grid, i, imgScale, item, j, k, l, r, ref, ref1, ref2, results, x, y;
      imgScale = 0.5;
      grid = {
        row: Math.ceil(window.innerWidth / (imgInfo.width * imgScale)),
        cols: Math.ceil(window.innerHeight / (imgInfo.height * imgScale)),
        rowWidth: imgInfo.width * imgScale,
        colHeight: imgInfo.height * imgScale
      };
      for (r = j = 0, ref = grid.row; (0 <= ref ? j < ref : j > ref); r = 0 <= ref ? ++j : --j) {
        x = r * grid.rowWidth;
        for (c = k = 0, ref1 = grid.cols; (0 <= ref1 ? k < ref1 : k > ref1); c = 0 <= ref1 ? ++k : --k) {
          y = c * grid.colHeight;
          item = new gridItem(x, y, grid.rowWidth, grid.colHeight);
          grids.push(item);
        }
      }
      results = [];
      for (i = l = 0, ref2 = grids.length; (0 <= ref2 ? l < ref2 : l > ref2); i = 0 <= ref2 ? ++l : --l) {
        results.push(grids[i].draw());
      }
      return results;
    };
  
    gridItem = function(x = 0, y = 0, w, h) {
      this.draw = function() {
        ctx.drawImage(img, x, y, w, h);
      };
    };
  
    Photo = function() {
      var TO_RADIANS, finalX, finalY, forceX, forceY, h, r, seed, w, x, y;
      seed = Math.random() * (2.5 - 0.7) + 0.7;
      w = imgInfo.width / seed;
      h = imgInfo.height / seed;
      x = window.innerWidth * Math.random();
      finalX = x;
      y = window.innerHeight * Math.random();
      finalY = y;
      console.log(`INIT Y :: ${finalY} || INIT X :: ${finalX}`);
      r = Math.random() * (180 - (-180)) + (-180);
      forceX = 0;
      forceY = 0;
      TO_RADIANS = Math.PI / 180;
      this.update = function() {
        var distance, dx, dy, powerX, powerY, x0, x1, y0, y1;
        x0 = x;
        y0 = y;
        x1 = mouse.x;
        y1 = mouse.y;
        dx = x1 - x0;
        dy = y1 - y0;
        distance = Math.sqrt((dx * dx) + (dy * dy));
        powerX = x0 - (dx / distance) * magnet / distance;
        powerY = y0 - (dy / distance) * magnet / distance;
        forceX = (forceX + (finalX - x0) / 2) / 2.1;
        forceY = (forceY + (finalY - y0) / 2) / 2.2;
        x = powerX + forceX;
        y = powerY + forceY;
      };
      this.draw = function() {
        return rotateAndPaintImage(ctx, img, r * TO_RADIANS, x, y, w / 2, h / 2, w, h);
      };
    };
  
    rotateAndPaintImage = function(context, image, angle, positionX, positionY, axisX, axisY, widthX, widthY) {
      context.translate(positionX, positionY);
      context.rotate(angle);
      context.drawImage(image, -axisX, -axisY, widthX, widthY);
      context.rotate(-angle);
      return context.translate(-positionX, -positionY);
    };
  
    render = function() {
      var x, y;
      x = 0;
      y = 0;
      ctx.clearRect(0, 0, width, height);
      while (y < grids.length) {
        grids[y].draw();
        y++;
      }
      while (x < imgs.length) {
        imgs[x].update();
        imgs[x].draw();
        x++;
      }
      return requestAnimationFrame(render);
    };
  
    init();
  
  }).call(this);
  
  //# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiPGFub255bW91cz4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQVc7RUFBQTtBQUFBLE1BQUEsS0FBQSxFQUFBLFlBQUEsRUFBQSxNQUFBLEVBQUEsVUFBQSxFQUFBLEdBQUEsRUFBQSxRQUFBLEVBQUEsS0FBQSxFQUFBLE1BQUEsRUFBQSxHQUFBLEVBQUEsT0FBQSxFQUFBLE1BQUEsRUFBQSxJQUFBLEVBQUEsSUFBQSxFQUFBLE1BQUEsRUFBQSxLQUFBLEVBQUEsY0FBQSxFQUFBLE1BQUEsRUFBQSxZQUFBLEVBQUEsbUJBQUEsRUFBQSxXQUFBLEVBQUEsT0FBQSxFQUFBOztFQUNYLE1BQUEsR0FBUyxRQUFRLENBQUMsY0FBVCxDQUF3QixRQUF4Qjs7RUFDVCxHQUFBLEdBQU0sTUFBTSxDQUFDLFVBQVAsQ0FBa0IsSUFBbEI7O0VBQ04sS0FBQSxHQUFRLE1BQU0sQ0FBQyxLQUFQLEdBQWUsTUFBTSxDQUFDOztFQUM5QixNQUFBLEdBQVMsTUFBTSxDQUFDLE1BQVAsR0FBZ0IsTUFBTSxDQUFDOztFQUNoQyxNQUFBLEdBQVMsTUFBTSxDQUFDLE9BQU8sQ0FBQzs7RUFDeEIsR0FBQSxHQUFNLElBQUksS0FBSixDQUFBOztFQUNOLE9BQUEsR0FBVTs7RUFDVixPQUFBLEdBQVUsQ0FBQTs7RUFDVixJQUFBLEdBQU87O0VBQ1AsS0FBQSxHQUFROztFQUNSLE1BQUEsR0FBUzs7RUFDVCxLQUFBLEdBQVE7SUFDUCxDQUFBLEVBQUUsQ0FESztJQUVQLENBQUEsRUFBRTtFQUZLOztFQUtSLElBQUEsR0FBTyxRQUFBLENBQUEsQ0FBQTtJQUNOLFlBQUEsQ0FBQTtJQUVBLEdBQUcsQ0FBQyxNQUFKLEdBQWEsUUFBQSxDQUFDLENBQUQsQ0FBQTtBQUNkLFVBQUEsWUFBQTs7TUFDRSxPQUFPLENBQUMsS0FBUixHQUFtQixDQUFDLENBQUMsSUFBTCxHQUFlLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBRCxDQUFHLENBQUMsS0FB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LElBQUEsQ0FBQTtBQXJKVyIsInNvdXJjZXNDb250ZW50IjpbIiMgVmFyaWFibGVzXG5jYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FudmFzJyk7XG5jdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcbndpZHRoID0gY2FudmFzLndpZHRoID0gd2luZG93LmlubmVyV2lkdGg7XG5oZWlnaHQgPSBjYW52YXMuaGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0O1xuaW1nU3JjID0gY2FudmFzLmRhdGFzZXQuaW1hZ2U7XG5pbWcgPSBuZXcgSW1hZ2UoKTtcbnVzZUdyaWQgPSB0cnVlXG5pbWdJbmZvID0ge307XG5pbWdzID0gW107XG5ncmlkcyA9IFtdO1xubWFnbmV0ID0gMjAwMDtcbm1vdXNlID0ge1xuXHR4OjFcblx0eTowXG59XG5cbmluaXQgPSAoKS0+XG5cdGFkZExpc3RlbmVycygpO1xuXHRcblx0aW1nLm9ubG9hZCA9IChlKS0+XG5cdFx0IyBDaGVjayBmb3IgZmlyZWZveC4gXG5cdFx0aW1nSW5mby53aWR0aCA9IGlmIGUucGF0aCB0aGVuIGUucGF0aFswXS53aWR0aCBlbHNlIGUudGFyZ2V0LndpZHRoXG5cdFx0aW1nSW5mby5oZWlnaHQgPSBpZiBlLnBhdGggdGhlbiBlLnBhdGhbMF0uaGVpZ2h0IGVsc2UgZS50YXJnZXQuaGVpZ2h0IFxuXHRcdFx0XG5cdFx0bnVtYmVyVG9TaG93ID0gKE1hdGguY2VpbCh3aW5kb3cuaW5uZXJXaWR0aCAvIGltZ0luZm8ud2lkdGgpKSAqIChNYXRoLmNlaWwod2luZG93LmlubmVySGVpZ2h0IC8gaW1nSW5mby5oZWlnaHQpKVxuXHRcdFxuXHRcdGNyZWF0ZUdyaWQoKSBpZiB1c2VHcmlkO1xuXHRcdHBvcHVsYXRlQ2FudmFzKG51bWJlclRvU2hvdyAqIDQpO1xuXHRcdFxuXHRcdCMgSW1hZ2UgaXMgcmVhZHkgYW5kIHdlJ3JlIHJlYWR5IHRvIGdvXG5cdFx0Y2FudmFzLmNsYXNzTGlzdC5hZGQoJ3JlYWR5Jyk7XG5cdFx0cmVuZGVyKCk7XG5cdFx0XG5cdGltZy5zcmMgPSBpbWdTcmM7XG5cdFxuYWRkTGlzdGVuZXJzID0gKCktPlxuXHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJyxyZXNpemVDYW52YXMpO1xuXHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgdXBkYXRlTW91c2UpO1xuXHR3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgdXBkYXRlTW91c2UpO1xuXHRcbnVwZGF0ZU1vdXNlID0gKGUpLT5cblxuXHRtb3VzZS54ID0gZS5jbGllbnRYXG5cdG1vdXNlLnkgPSBlLmNsaWVudFlcblx0XG5yZXNpemVDYW52YXMgPSAoKS0+XG5cdHdpZHRoID0gY2FudmFzLndpZHRoID0gd2luZG93LmlubmVyV2lkdGg7XG5cdGhlaWdodCA9IGNhbnZhcy5oZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7XG5cdFxuIyBNYWdpY1xucG9wdWxhdGVDYW52YXMgPSAobmIpLT5cblx0aSA9IDA7XG5cdHdoaWxlIGkgPD0gbmJcblx0XHRwID0gbmV3IFBob3RvKCk7XG5cdFx0aW1ncy5wdXNoIHBcblx0XHRpKys7XG5cdFxuY3JlYXRlR3JpZCA9ICgpLT5cblx0aW1nU2NhbGUgPSAwLjVcblx0Z3JpZCA9IHtcblx0XHRyb3c6IE1hdGguY2VpbCh3aW5kb3cuaW5uZXJXaWR0aCAvIChpbWdJbmZvLndpZHRoICogaW1nU2NhbGUpKVxuXHRcdGNvbHM6IE1hdGguY2VpbCh3aW5kb3cuaW5uZXJIZWlnaHQgLyAoaW1nSW5mby5oZWlnaHQgKiBpbWdTY2FsZSkpXG5cdFx0cm93V2lkdGg6IGltZ0luZm8ud2lkdGggKiBpbWdTY2FsZVxuXHRcdGNvbEhlaWdodDogaW1nSW5mby5oZWlnaHQgKiBpbWdTY2FsZVxuXHR9XG5cdFxuXHRmb3IgciBpbiBbMC4uLmdyaWQucm93XVxuXHRcdHggPSByICogZ3JpZC5yb3dXaWR0aFxuXHRcdGZvciBjIGluIFswLi4uZ3JpZC5jb2xzXVxuXHRcdFx0eSA9IGMgKiBncmlkLmNvbEhlaWdodFxuXHRcdFx0XG5cdFx0XHRpdGVtID0gbmV3IGdyaWRJdGVtKHgseSxncmlkLnJvd1dpZHRoLGdyaWQuY29sSGVpZ2h0KVxuXHRcdFx0Z3JpZHMucHVzaCBpdGVtO1xuXHRcdFx0XG5cdGZvciBpIGluIFswLi4uZ3JpZHMubGVuZ3RoXVxuXHRcdGdyaWRzW2ldLmRyYXcoKTtcblx0XG5ncmlkSXRlbSA9ICh4ID0gMCwgeSA9IDAsIHcsIGgpLT5cblx0dGhpcy5kcmF3ID0gKCktPlxuXHRcdGN0eC5kcmF3SW1hZ2UoaW1nLCB4LCB5LCB3LCBoKTtcblx0XHRyZXR1cm5cblx0cmV0dXJuXG5cblBob3RvID0gKCktPlxuXHRzZWVkID0gTWF0aC5yYW5kb20oKSAqICgyLjUgLSAwLjcpICsgMC43O1xuXHR3ID0gaW1nSW5mby53aWR0aCAvIHNlZWRcblx0aCA9IGltZ0luZm8uaGVpZ2h0IC8gc2VlZFxuXHR4ID0gd2luZG93LmlubmVyV2lkdGggKiBNYXRoLnJhbmRvbSgpXG5cdGZpbmFsWCA9IHhcblx0eSA9IHdpbmRvdy5pbm5lckhlaWdodCAqIE1hdGgucmFuZG9tKClcblx0ZmluYWxZID0geVx0XG5cdGNvbnNvbGUubG9nKFwiSU5JVCBZIDo6ICN7ZmluYWxZfSB8fCBJTklUIFggOjogI3tmaW5hbFh9XCIpXG5cdHIgPSBNYXRoLnJhbmRvbSgpICogKDE4MCAtICgtMTgwKSkgKyAoLTE4MClcblx0XG5cdGZvcmNlWCA9IDBcblx0Zm9yY2VZID0gMFxuXHRcblx0VE9fUkFESUFOUyA9IE1hdGguUEkvMTgwXG5cdFxuXHR0aGlzLnVwZGF0ZSA9ICgpLT5cblx0XHR4MCA9IHhcblx0XHR5MCA9IHlcblx0XHR4MSA9IG1vdXNlLnhcblx0XHR5MSA9IG1vdXNlLnlcblx0XHRcblx0XHRkeCA9IHgxIC0geDBcblx0XHRkeSA9IHkxIC0geTBcblx0XHRcblx0XHRkaXN0YW5jZSA9IE1hdGguc3FydCgoZHggKiBkeCkgKyAoZHkgKiBkeSkpXG5cdFx0cG93ZXJYID0geDAgLSAoZHggLyBkaXN0YW5jZSkgKiBtYWduZXQgLyBkaXN0YW5jZTtcblx0XHRwb3dlclkgPSB5MCAtIChkeSAvIGRpc3RhbmNlKSAqIG1hZ25ldCAvIGRpc3RhbmNlXG5cdFx0XG5cdFx0Zm9yY2VYID0gKGZvcmNlWCArIChmaW5hbFggLSB4MCkgLyAyKSAvIDIuMVxuXHRcdGZvcmNlWSA9IChmb3JjZVkgKyAoZmluYWxZIC0geTApIC8gMikgLyAyLjJcblxuXHRcdFxuXG5cdFx0eCA9IHBvd2VyWCArIGZvcmNlWFxuXHRcdHkgPSBwb3dlclkgKyBmb3JjZVlcblx0XG5cdFx0cmV0dXJuXG5cdHRoaXMuZHJhdyA9ICgpLT5cblx0XHRyb3RhdGVBbmRQYWludEltYWdlKGN0eCwgaW1nLCByICogVE9fUkFESUFOUywgeCwgeSwgdyAvIDIsIGggLyAyLCB3LCBoKVxuXHRyZXR1cm5cblxucm90YXRlQW5kUGFpbnRJbWFnZSA9ICggY29udGV4dCwgaW1hZ2UsIGFuZ2xlICwgcG9zaXRpb25YLCBwb3NpdGlvblksIGF4aXNYLCBheGlzWSwgd2lkdGhYLCB3aWR0aFkpLT5cblx0Y29udGV4dC50cmFuc2xhdGUoIHBvc2l0aW9uWCwgcG9zaXRpb25ZICk7XG5cdGNvbnRleHQucm90YXRlKCBhbmdsZSApO1xuXHRjb250ZXh0LmRyYXdJbWFnZSggaW1hZ2UsIC1heGlzWCwgLWF4aXNZLCB3aWR0aFgsIHdpZHRoWSApO1xuXHRjb250ZXh0LnJvdGF0ZSggLWFuZ2xlICk7XG5cdGNvbnRleHQudHJhbnNsYXRlKCAtcG9zaXRpb25YLCAtcG9zaXRpb25ZICk7XG5cbnJlbmRlciA9ICgpLT5cblx0eCA9IDBcblx0eSA9IDBcblx0Y3R4LmNsZWFyUmVjdCgwLDAsd2lkdGgsaGVpZ2h0KVxuXHR3aGlsZSB5IDwgZ3JpZHMubGVuZ3RoXG5cdFx0Z3JpZHNbeV0uZHJhdygpXG5cdFx0eSsrXG5cdHdoaWxlIHggPCBpbWdzLmxlbmd0aFxuXHRcdGltZ3NbeF0udXBkYXRlKClcblx0XHRpbWdzW3hdLmRyYXcoKVxuXHRcdHgrK1xuXHRcdFxuXHRyZXF1ZXN0QW5pbWF0aW9uRnJhbWUgcmVuZGVyXG5cdFxuXHRcblx0XHRcbmluaXQoKTsiXX0=
  //# sourceURL=coffeescript